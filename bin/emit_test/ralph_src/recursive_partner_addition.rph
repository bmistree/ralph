Endpoint RecursiveAdder
{
    TVar Number internal_num;
    
    set_internal_num(Number to_set_to)
    {
        internal_num = to_set_to;
    }

    partner_recursive_add_to_number(Number remaining_iters) returns Number
    {
        Number to_return;
        atomically
        {
            if (remaining_iters == 0)
                to_return = 0;
            else
            {
                remaining_iters -= 1;
                Number recursive_result;
                recursive_result = 
                    @partner.partner_recursive_add_to_number(remaining_iters);
                to_return = internal_num + recursive_result;
            }
        }
        return to_return;
    }
}
